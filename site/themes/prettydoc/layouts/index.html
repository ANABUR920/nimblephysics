{{ define "main" }}
<section class="bg-primary bg-hero-dropshadow">
  <div class="container">
    <div class="row justify-content-center">
      <img src="assets/images/logos.svg" alt="Pytorch and DART Logos">
      <div class="col-lg-10 text-white text-center">
        <h1 class="font-weight-light">Stanford DiffDART: Pre-alpha</h1>
      </div>
    </div>
    <div class="row justify-content-center mt-1">
      <div class="text-white text-center hero-code">
        pip3 install diffdart
      </div>
    </div>
    <div class="row justify-content-center mt-1">
      <div class="col-lg-7 text-white text-center">
        <p>
          Fast and open source fork of popular physics engine <a href="https://dartsim.github.io/">DART</a>, now with gradients. Use full 3D physics (with articulated bodies and contacts) as a non-linearity in <a href="https://pytorch.org/">PyTorch</a>!
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col text-center">
        <a href="/tuts/getting_started/" class="btn btn-white">
          Get Started
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col text-center">
        <a class="github-button" href="https://github.com/keenon/diffdart" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-size="large" data-show-count="true" aria-label="Star keenon/diffdart on GitHub">Star</a>
      </div>
    </div>
    <div class="row">
      <div class="col-lg 4 text-center text-white">
      </div>
    </div>
  </div>
</section>
<!-- / hero -->



<!--
<section class="half bg-primary">
  <div class="half-bg bg-light pb-10">
    <div class="image image-gradient-vertical" style="background-image:url(../../assets/images/image.jpg)"></div>
  </div>
  <div class="container-full mb-10">
    <div class="row gutter-0 justify-content-center">
      <div class="col-12">
        <div class="owl-carousel owl-carousel-showcase owl-carousel-fluid" data-items="[3,2,1]" data-center="true" data-margin="30" data-nav="true" data-loop="true">
          <div class="card card-showcase lift">
            <a href="html/docs/layout-1.html">
              <img class="card-img-top" src="assets/images/layout-1.png" alt="Documentation Layout 1">
            </a>
          </div>
          <div class="card card-showcase lift">
            <a href="html/docs/layout-2.html">
              <img class="card-img-top" src="assets/images/layout-2.png" alt="Documentation Layout 2">
            </a>
          </div>
          <div class="card card-showcase lift">
            <a href="html/pages/changelog.html">
              <img class="card-img-top" src="assets/images/changelog.png" alt="Changelog">
            </a>
          </div>
          <div class="card card-showcase lift">
            <a href="html/docs/layout-4.html">
              <img class="card-img-top" src="assets/images/layout-4.png" alt="Documentation Layout 4">
            </a>
          </div>
          <div class="card card-showcase lift">
            <a href="html/help/homepage-1.html">
              <img class="card-img-top" src="assets/images/helpcenter.png" alt="Helpcenter">
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
-->


<!-- components -->
<section class="pt-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 text-center">
        <h2>Use Physics as a layer <br/><b>in your Neural Net</b></h2>
        <p>Treat the DART physics engine (featuring articulated rigidbodies, contacts, and friction) like any other Pytorch function, and get automatic differentiation!</p>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="crossfade crossfade-dataflow">
        <img class="top" src="assets/images/data-flow-fwd.svg"/>
        <img class="bottom" src="assets/images/data-flow-back.svg"/>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-md-6 text-center">
        <h2>Get <b>powerful</b> visualizations</h2>
        <p>Use our rich web UI to analyze your trajectories, <i>and</i> the learning process that found them.</p>
      </div>
    </div>
    <div class="row justify-content-center">
      <div style="height: 550px; width: 750px; box-shadow: 0 0 10px 0 rgba(0,0,0,0.2);" id="3d-viewer">
      </div>
      <!-- <iframe src="assets/viewer/index.html" height="550px" width="750px"></iframe> -->
    </div>
    <div class="row justify-content-center">
      <a href="assets/viewer/">Full page version of 3D viewer</a>
    </div>
    <!--
    <div class="row justify-content-center">
        <div class="card">
          <div class="card-body">
                <pre><code class="language-py">import diffdart
import torch

# Once your world is set up, you have these variables:

# world: diffdart.simulation.World
# positions: torch.Tensor
# velocities: torch.Tensor
# forces: torch.Tensor

# Run a timestep
new_positions, new_velocities = diffdart.dart_layer(world, 
                                                positions, 
                                                velocities,
                                                forces)

# Do something with the output, and backprop!
loss = new_positions.norm() + new_velocities.norm()
loss.backprop()

# Read gradients off your pre-timestep inputs
print(positions.grad)</code></pre>
        </div>
      </div>
    </div>
    -->
  </div>
</section>  
<!-- / components -->



<!-- categories -->
<section class="bg-white">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 text-center">
        <h2>Gradients without sacrificing <b>Contact and Friction</b></h2>
        <p>We use a novel approach to be able to differentiatie through the <a href="https://en.wikipedia.org/wiki/Linear_complementarity_problem">Linear Complimentarity Problem</a> at the heart of DART's contact and friction model.</p>
      </div>
    </div>
    <div class="row">
      <div class="col text-center">
        <a href="/discussion/background/" class="btn btn-info">Geek out about the math!</a>
        <a href="/tuts/getting_started/" class="btn btn-primary">Get Started</a>
      </div>
    </div>
  </div>
</section>
<!-- / categories -->



<!-- cta -->
<div class="half bg-white">
  <span class="half-bg bg-dark"></span>
  <div class="container">
    <div class="row">
      <div class="col">
        <div class="cta boxed no-border bg-primary p-3 p-md-5">
          <i class="icon-unlock icon-background text-white"></i>
          <div class="row">
            <div class="col text-white">
              <h2>Help AI improve in the <b>Physical World</b></h2>
              <p class="lead">Use DiffDART to develop novel AI for interacting with the physical world. <a href="/tuts/getting_started/" class="action text-white">Get Started</a></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- / cta -->
<script type="text/javascript">
function onload() {
  if (document.readyState !== 'complete') {
    return;
  }
  var viewer = document.getElementById("3d-viewer");
  var window = new document.DARTWindow(viewer);
  window.registerRemoteData("Catapult", "/data/catapult.txt").then(function() {
    window.registerRemoteData("Cartpole", "/data/cartpole.txt").then(function() {
      window.registerRemoteData("Jumping Worm", "/data/worm.txt");
    });
  });
}

if (document.readyState == 'complete') {
  onload();
}
else {
  document.addEventListener("readystatechange", onload);
}
</script>
{{ end }}
